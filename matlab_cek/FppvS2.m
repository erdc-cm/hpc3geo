function [Fpp]=FpvS(S)
global q
global m
global rhow
global rhon
global g
global muw
global mun
global ki
lamiw = ki/muw;
lamin = ki/mun;

Fpp = (-1./4.*lamiw./S.^(3./2).*(1-(1-S.^(1./m)).^m).^2.*q+2.*lamiw./S.^(3./2).*((1-S.^(1./m)).^m).^2.*(S.^(1./m)).^2./(1-S.^(1./m)).^2.*q-2.*lamiw./S.^(3./2).*(1-(1-S.^(1./m)).^m).*q.*(1-S.^(1./m)).^m.*(S.^(1./m)).^2./(1-S.^(1./m)).^2+2.*lamiw./S.^(3./2).*(1-(1-S.^(1./m)).^m).*q.*(1-S.^(1./m)).^m.*S.^(1./m)./m./(1-S.^(1./m))+2.*lamiw./S.^(3./2).*(1-(1-S.^(1./m)).^m).*q.*(1-S.^(1./m)).^m.*(S.^(1./m)).^2./(1-S.^(1./m)).^2./m+1./4.*lamiw./S.^(3./2).*(1-(1-S.^(1./m)).^m).^2.*lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*(rhon-rhow).*g+1./2.*lamiw./S.^(1./2).*(1-(1-S.^(1./m)).^m).^2.*lamin./(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*(rhon-rhow).*g-2.*lamiw./S.^(3./2).*((1-S.^(1./m)).^m).^2.*(S.^(1./m)).^2./(1-S.^(1./m)).^2.*lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*(rhon-rhow).*g+2.*lamiw./S.^(1./2).*(1-(1-S.^(1./m)).^m).*lamin./(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*(rhon-rhow).*g.*(1-S.^(1./m)).^m.*S.^(1./m)./(1-S.^(1./m))+10.*lamiw./S.^(3./2).*(1-(1-S.^(1./m)).^m).*lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*(S.^(1./m)).^2./(1-S.^(1./m)).^2.*(rhon-rhow).*g.*(1-S.^(1./m)).^m-2.*lamiw./S.^(3./2).*(1-(1-S.^(1./m)).^m).*lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*(rhon-rhow).*g.*(1-S.^(1./m)).^m.*S.^(1./m)./m./(1-S.^(1./m))-2.*lamiw./S.^(3./2).*(1-(1-S.^(1./m)).^m).*lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*(rhon-rhow).*g.*(1-S.^(1./m)).^m.*(S.^(1./m)).^2./(1-S.^(1./m)).^2./m+1./4.*lamiw.*S.^(1./2).*(1-(1-S.^(1./m)).^m).^2.*lamin./(1-S).^(3./2).*(1-S.^(1./m)).^(2.*m).*(rhon-rhow).*g-2.*lamiw./S.^(1./2).*(1-(1-S.^(1./m)).^m).^2.*lamin./(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*S.^(1./m)./(1-S.^(1./m)).*(rhon-rhow).*g-4.*lamiw./S.^(3./2).*(1-(1-S.^(1./m)).^m).^2.*lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*(S.^(1./m)).^2./(1-S.^(1./m)).^2.*(rhon-rhow).*g+2.*lamiw./S.^(3./2).*(1-(1-S.^(1./m)).^m).^2.*lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*S.^(1./m)./m./(1-S.^(1./m)).*(rhon-rhow).*g+2.*lamiw./S.^(3./2).*(1-(1-S.^(1./m)).^m).^2.*lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*(S.^(1./m)).^2./(1-S.^(1./m)).^2.*(rhon-rhow).*g./m)./(lamiw.*S.^(1./2).*(1-(1-S.^(1./m)).^m).^2+lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m))-2.*(1./2.*lamiw./S.^(1./2).*(1-(1-S.^(1./m)).^m).^2.*q+2.*lamiw./S.^(1./2).*(1-(1-S.^(1./m)).^m).*q.*(1-S.^(1./m)).^m.*S.^(1./m)./(1-S.^(1./m))-1./2.*lamiw./S.^(1./2).*(1-(1-S.^(1./m)).^m).^2.*lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*(rhon-rhow).*g-2.*lamiw./S.^(1./2).*(1-(1-S.^(1./m)).^m).*lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*(rhon-rhow).*g.*(1-S.^(1./m)).^m.*S.^(1./m)./(1-S.^(1./m))+1./2.*lamiw.*S.^(1./2).*(1-(1-S.^(1./m)).^m).^2.*lamin./(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*(rhon-rhow).*g+2.*lamiw./S.^(1./2).*(1-(1-S.^(1./m)).^m).^2.*lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*S.^(1./m)./(1-S.^(1./m)).*(rhon-rhow).*g)./(lamiw.*S.^(1./2).*(1-(1-S.^(1./m)).^m).^2+lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m)).^2.*(1./2.*lamiw./S.^(1./2).*(1-(1-S.^(1./m)).^m).^2+2.*lamiw./S.^(1./2).*(1-(1-S.^(1./m)).^m).*(1-S.^(1./m)).^m.*S.^(1./m)./(1-S.^(1./m))-1./2.*lamin./(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m)-2.*lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*S.^(1./m)./S./(1-S.^(1./m)))+2.*(lamiw.*S.^(1./2).*(1-(1-S.^(1./m)).^m).^2.*q-lamiw.*S.^(1./2).*(1-(1-S.^(1./m)).^m).^2.*lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*(rhon-rhow).*g)./(lamiw.*S.^(1./2).*(1-(1-S.^(1./m)).^m).^2+lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m)).^3.*(1./2.*lamiw./S.^(1./2).*(1-(1-S.^(1./m)).^m).^2+2.*lamiw./S.^(1./2).*(1-(1-S.^(1./m)).^m).*(1-S.^(1./m)).^m.*S.^(1./m)./(1-S.^(1./m))-1./2.*lamin./(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m)-2.*lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*S.^(1./m)./S./(1-S.^(1./m))).^2-(lamiw.*S.^(1./2).*(1-(1-S.^(1./m)).^m).^2.*q-lamiw.*S.^(1./2).*(1-(1-S.^(1./m)).^m).^2.*lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*(rhon-rhow).*g)./(lamiw.*S.^(1./2).*(1-(1-S.^(1./m)).^m).^2+lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m)).^2.*(-1./4.*lamiw./S.^(3./2).*(1-(1-S.^(1./m)).^m).^2+2.*lamiw./S.^(3./2).*((1-S.^(1./m)).^m).^2.*(S.^(1./m)).^2./(1-S.^(1./m)).^2-2.*lamiw./S.^(3./2).*(1-(1-S.^(1./m)).^m).*(1-S.^(1./m)).^m.*(S.^(1./m)).^2./(1-S.^(1./m)).^2+2.*lamiw./S.^(3./2).*(1-(1-S.^(1./m)).^m).*(1-S.^(1./m)).^m.*S.^(1./m)./m./(1-S.^(1./m))+2.*lamiw./S.^(3./2).*(1-(1-S.^(1./m)).^m).*(1-S.^(1./m)).^m.*(S.^(1./m)).^2./(1-S.^(1./m)).^2./m-1./4.*lamin./(1-S).^(3./2).*(1-S.^(1./m)).^(2.*m)+2.*lamin./(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*S.^(1./m)./S./(1-S.^(1./m))+4.*lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*(S.^(1./m)).^2./S.^2./(1-S.^(1./m)).^2-2.*lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*S.^(1./m)./m./S.^2./(1-S.^(1./m))+2.*lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*S.^(1./m)./S.^2./(1-S.^(1./m))-2.*lamin.*(1-S).^(1./2).*(1-S.^(1./m)).^(2.*m).*(S.^(1./m)).^2./S.^2./(1-S.^(1./m)).^2./m);


return;